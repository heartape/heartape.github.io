<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mysql基础 | Heartape</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="favicon.ico">
    <script src="/assets/js/bodyClick.js"></script>
    <meta name="description" content="你也想起舞吗">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.a1a12807.css" as="style"><link rel="preload" href="/assets/js/app.9604687e.js" as="script"><link rel="preload" href="/assets/js/3.67b42e06.js" as="script"><link rel="preload" href="/assets/js/1.ba3d0679.js" as="script"><link rel="preload" href="/assets/js/67.869a3181.js" as="script"><link rel="prefetch" href="/assets/js/10.e9699e73.js"><link rel="prefetch" href="/assets/js/11.8cba39cc.js"><link rel="prefetch" href="/assets/js/12.abedb4b9.js"><link rel="prefetch" href="/assets/js/13.684e984b.js"><link rel="prefetch" href="/assets/js/14.fabd1944.js"><link rel="prefetch" href="/assets/js/15.3a201786.js"><link rel="prefetch" href="/assets/js/16.0c1eeaf6.js"><link rel="prefetch" href="/assets/js/17.ee87c8cd.js"><link rel="prefetch" href="/assets/js/18.2a3010da.js"><link rel="prefetch" href="/assets/js/19.565e82f3.js"><link rel="prefetch" href="/assets/js/20.d3c75fe8.js"><link rel="prefetch" href="/assets/js/21.3d4ebbb8.js"><link rel="prefetch" href="/assets/js/22.2c24d75e.js"><link rel="prefetch" href="/assets/js/23.dcac00c6.js"><link rel="prefetch" href="/assets/js/24.ff211a1d.js"><link rel="prefetch" href="/assets/js/25.015a2c3e.js"><link rel="prefetch" href="/assets/js/26.6c3bca1f.js"><link rel="prefetch" href="/assets/js/27.0e6f5ba7.js"><link rel="prefetch" href="/assets/js/28.cc17e3aa.js"><link rel="prefetch" href="/assets/js/29.8a3dd91f.js"><link rel="prefetch" href="/assets/js/30.5514f209.js"><link rel="prefetch" href="/assets/js/31.4a4524b5.js"><link rel="prefetch" href="/assets/js/32.43607dfe.js"><link rel="prefetch" href="/assets/js/33.db213607.js"><link rel="prefetch" href="/assets/js/34.81cb7c32.js"><link rel="prefetch" href="/assets/js/35.fc02eb3e.js"><link rel="prefetch" href="/assets/js/36.03c09aeb.js"><link rel="prefetch" href="/assets/js/37.1ea7e6a7.js"><link rel="prefetch" href="/assets/js/38.d9548777.js"><link rel="prefetch" href="/assets/js/39.37d0f76c.js"><link rel="prefetch" href="/assets/js/4.98ef80d5.js"><link rel="prefetch" href="/assets/js/40.ebb103cd.js"><link rel="prefetch" href="/assets/js/41.8696b517.js"><link rel="prefetch" href="/assets/js/42.7e7d440d.js"><link rel="prefetch" href="/assets/js/43.9b2c4e79.js"><link rel="prefetch" href="/assets/js/44.9fdc51f4.js"><link rel="prefetch" href="/assets/js/45.be0d891a.js"><link rel="prefetch" href="/assets/js/46.c7c671fa.js"><link rel="prefetch" href="/assets/js/47.2faf24ca.js"><link rel="prefetch" href="/assets/js/48.4bae39f1.js"><link rel="prefetch" href="/assets/js/49.2734277f.js"><link rel="prefetch" href="/assets/js/5.400b49fd.js"><link rel="prefetch" href="/assets/js/50.3d847444.js"><link rel="prefetch" href="/assets/js/51.40fc0ce6.js"><link rel="prefetch" href="/assets/js/52.f2868485.js"><link rel="prefetch" href="/assets/js/53.a3749151.js"><link rel="prefetch" href="/assets/js/54.c33cab28.js"><link rel="prefetch" href="/assets/js/55.12b6198c.js"><link rel="prefetch" href="/assets/js/56.cbbf6e6d.js"><link rel="prefetch" href="/assets/js/57.83b370a6.js"><link rel="prefetch" href="/assets/js/58.56ac42b0.js"><link rel="prefetch" href="/assets/js/59.d0e3af0f.js"><link rel="prefetch" href="/assets/js/6.31135b7c.js"><link rel="prefetch" href="/assets/js/60.e36f02c6.js"><link rel="prefetch" href="/assets/js/61.a4ed0070.js"><link rel="prefetch" href="/assets/js/62.23cebb58.js"><link rel="prefetch" href="/assets/js/63.a8bcb6de.js"><link rel="prefetch" href="/assets/js/64.b42d7871.js"><link rel="prefetch" href="/assets/js/65.bd815697.js"><link rel="prefetch" href="/assets/js/66.6cd45dd2.js"><link rel="prefetch" href="/assets/js/68.44ff8c21.js"><link rel="prefetch" href="/assets/js/69.87c8573b.js"><link rel="prefetch" href="/assets/js/7.90420d98.js"><link rel="prefetch" href="/assets/js/70.eaa9c566.js"><link rel="prefetch" href="/assets/js/71.08b1859d.js"><link rel="prefetch" href="/assets/js/72.70ae92cf.js"><link rel="prefetch" href="/assets/js/73.92d31d2c.js"><link rel="prefetch" href="/assets/js/74.e0d458ba.js"><link rel="prefetch" href="/assets/js/75.bc9f70c9.js"><link rel="prefetch" href="/assets/js/76.e022c340.js"><link rel="prefetch" href="/assets/js/77.ae12a4ee.js"><link rel="prefetch" href="/assets/js/78.3b44f8b4.js"><link rel="prefetch" href="/assets/js/79.df42e14c.js"><link rel="prefetch" href="/assets/js/8.cfca4993.js"><link rel="prefetch" href="/assets/js/80.4790094c.js"><link rel="prefetch" href="/assets/js/9.0c54c5b1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a1a12807.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Heartape</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Heartape</span>
            
          <span data-v-64685f0e>2022 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/image/hero.png" alt="Heartape" class="logo"> <span class="site-name">Heartape</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      技术
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/docs/java/java8.html" class="nav-link"><i class="iconfont undefined"></i>
  JAVA
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/frame/spring5.html" class="nav-link"><i class="iconfont undefined"></i>
  框架
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/source/springSource.html" class="nav-link"><i class="iconfont undefined"></i>
  源码
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/middleware/mysql.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  中间件
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/tool/git.html" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时光走过了哪里
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-account"></i>
      我在哪里
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/heartape" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/heartape" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://space.bilibili.com/247318527" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bilibili"></i>
  Bilibili
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:heartape@163.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  163
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/assets/image/hero.png" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    Heartape
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>44</h3> <h6 data-v-ca798c94>文章</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>46</h3> <h6 data-v-ca798c94>标签</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      技术
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/docs/java/java8.html" class="nav-link"><i class="iconfont undefined"></i>
  JAVA
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/frame/spring5.html" class="nav-link"><i class="iconfont undefined"></i>
  框架
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/source/springSource.html" class="nav-link"><i class="iconfont undefined"></i>
  源码
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/middleware/mysql.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  中间件
</a></li><li class="dropdown-item"><!----> <a href="/blogs/docs/tool/git.html" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时光走过了哪里
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-account"></i>
      我在哪里
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/heartape" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/heartape" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://space.bilibili.com/247318527" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bilibili"></i>
  Bilibili
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:heartape@163.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  163
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/blogs/docs/middleware/mysql.html" aria-current="page" class="active sidebar-link">mysql基础</a></li><li><a href="/blogs/docs/middleware/redis-resp.html" class="sidebar-link">redis深入探究(1) - RESP协议</a></li><li><a href="/blogs/docs/middleware/redis-scan.html" class="sidebar-link">redis深入探究(2) - scan</a></li><li><a href="/blogs/docs/middleware/redis-rehash.html" class="sidebar-link">redis深入探究(3) - rehash</a></li><li><a href="/blogs/docs/middleware/redis-skiplist.html" class="sidebar-link">redis深入探究(4) - skip list</a></li><li><a href="/blogs/docs/middleware/sharding-jdbc.html" class="sidebar-link">sharding-jdbc基础</a></li><li><a href="/blogs/docs/middleware/nginx.html" class="sidebar-link">nginx基础</a></li><li><a href="/blogs/docs/middleware/RabbitMQ.html" class="sidebar-link">RabbitMQ基础</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>mysql基础</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Heartape</span>
            
          <span data-v-64685f0e>2022 - </span>
          2023
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>mysql基础</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>Heartape</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2022-06-12</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>mysql</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="_1-explain"><a href="#_1-explain" class="header-anchor">#</a> 1.explain</h2> <p>explain命令会获取select语句的执行计划，但没有真正执行，我们可以从中寻找sql优化的方向</p> <p>执行计划主要有以下几个:</p> <ul><li>select_type: 查询的类型
<ul><li>simple: 简单查询</li> <li>primary: 复杂查询中最外层的select</li> <li>subquery: 包含不在from中的子查询</li> <li>derived: 包含在from子句中的子查询。MySQL会将结果存放在一个临时表中，也称为派生表</li> <li>union: union之后的select</li> <li>union result: union结果的select</li></ul></li> <li>type: 关联类型，性能排行system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL
<ul><li>NULL:mysql能够在优化阶段分解查询语句，在执行阶段用不着再访问表或索引。比如数据在索引中不需要回表。</li> <li>const, system:主表唯一索引匹配</li> <li>eq_ref:从表，唯一索引完全匹配</li> <li>ref:从表，唯一索引不完全匹配或者使用普通索引</li> <li>ref_or_null:从表，唯一索引不完全匹配或者使用普通索引，并且条件中包含null值判断(is null)</li> <li>index_merge:优化时进行了索引合并</li> <li>range: in(), between ,&gt; ,&lt;, &gt;=, &lt;&gt; 等范围查询</li> <li>index: 扫描整个索引树</li> <li>ALL: 全表扫描(注意，数据较少会直接全表扫描，不会使用索引)</li></ul></li> <li>possible_keys:可能使用的索引</li> <li>key:实际使用的索引</li> <li>key_len:索引里使用的字节数，不同的类型所占据的字节数不同
<ul><li>char(n):n字符长度(utf-8编码下，每个字符3字节，定义的字段长度都是字符数)</li> <li>varchar(n):1或2(长度大于255)字节存储字符串长度，则字节数为，实际字符数 * 3 + 1或2</li> <li>tinyint:1字节</li> <li>smallint:2字节</li> <li>int:4字节</li> <li>bigint:8字节</li> <li>date:3字节</li> <li>timestamp:4字节</li> <li>datetime:8字节</li></ul></li></ul> <h2 id="_2-索引"><a href="#_2-索引" class="header-anchor">#</a> 2.索引</h2> <p>通过explain的内容可以看出，索引对于查询的性能至关重要，所以这部分说说索引。</p> <h3 id="_1-b-tree"><a href="#_1-b-tree" class="header-anchor">#</a> 1.B+TREE</h3> <p>B+ TREE相比其他结构来说有非常大的优势</p> <ul><li>相比B TREE来说，因为数据都在叶子节点，查找相邻数据时可以通过左右指针来查找，而不用通过树结构往上回溯。</li> <li>相比hash来说，不会存在hash冲突，所以更稳定，并且hash是散列的，不能支持排序和范围查询。</li></ul> <h3 id="_2-innodb和myisam的索引区别"><a href="#_2-innodb和myisam的索引区别" class="header-anchor">#</a> 2.InnoDB和MyISAM的索引区别</h3> <p>MyISAM:</p> <ul><li>索引均为非聚簇索引，索引保存了指向数据的指针，数据与索引分离。</li> <li>MyISAM不支持事务,原因就是因为数据与索引在两个文件无法做到一致性。</li> <li>支持全文索引。
InnoDB:</li> <li>主键索引为聚簇索引，同时保存了所有数据（如果没有主键，系统会隐式地创建）。</li> <li>二级索引为非聚簇索引，保存了主键值，用于到主键索引二次查询（即回表）。</li></ul> <h3 id="_3-最左匹配原则"><a href="#_3-最左匹配原则" class="header-anchor">#</a> 3.最左匹配原则</h3> <p>联合索引不会保存数据所以当使用索引时，会先拿到主键，再回表拿数据。但当需要查询的数据在索引中时，便可以利用最左匹配原则省去回表环节。比如：<br>
有一个a,b,c三个字段的联合索引，如果where条件中使用到了a=1,b=2,且查询对象时c时，就可以免去回表。<br>
之所以叫最左匹配原则，是因为它严格要求索引的建立顺序必须条件在左，结果在右，这跟索引的数据结构有关。索引会把a和b字段建立成1对n的关系，所以无法逆向使用最左匹配原则。</p> <h3 id="_4-性能调优"><a href="#_4-性能调优" class="header-anchor">#</a> 4.性能调优</h3> <p>1.鉴于mysql索引的排序机制，我们很容易得到第一点：主键。<br>
一般来说，有序的主键性能更强。如果主键是十分散列的:</p> <ul><li>每次插入时都需要寻找插入的位置，效率低下。</li> <li>由于需要排序，所以需要重新将数据向后移动，页满了以后会进行大量的页分裂操作，需要进行多次io。</li> <li>由于频繁的页分裂，造成内存碎片化，分配的内存不能充分使用，后续查找数据也跟困难。</li></ul> <p>2.充分利用最左匹配原则，减少索引的数量</p> <p>3.只建立必要的索引，索引需要大量存储空间，并且在插入删除时需要维护索引，影响性能。</p> <h2 id="_3-json数据类型"><a href="#_3-json数据类型" class="header-anchor">#</a> 3.json数据类型</h2> <blockquote><p>低版本不支持json类型，某些函数需要更高的版本</p></blockquote> <h3 id="_1-定义"><a href="#_1-定义" class="header-anchor">#</a> 1.定义</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>JSON_OBJECT<span class="token punctuation">(</span>key1<span class="token punctuation">,</span> value1<span class="token punctuation">,</span> key2<span class="token punctuation">,</span> value2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">key</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
JSON_ARRAY<span class="token punctuation">(</span>value1 <span class="token punctuation">,</span> value2 <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">value</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 将多个json对象聚合成一个对象</span>
JSON_MERGE<span class="token punctuation">(</span>JSON_OBJECT<span class="token punctuation">(</span>key1 <span class="token punctuation">,</span> value1<span class="token punctuation">)</span> <span class="token punctuation">,</span>JSON_OBJECT<span class="token punctuation">(</span>key2 <span class="token punctuation">,</span> value2<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-where"><a href="#_2-where" class="header-anchor">#</a> 2.where</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- `attributes`下的ports下的mysql的值作为条件</span>
<span class="token keyword">where</span> JSON_EXTRACT<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>attributes<span class="token punctuation">`</span></span> <span class="token punctuation">,</span> <span class="token string">'$.ports.mysql'</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3306</span>
<span class="token comment">-- 简写</span>
<span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">`</span>attributes<span class="token punctuation">`</span></span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'$.ports.mysql'</span> <span class="token operator">=</span> <span class="token number">3306</span>
<span class="token comment">-- 模糊匹配,[*]代表任意数组下标,.*代表任意属性</span>
<span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">`</span>attributes<span class="token punctuation">`</span></span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'$[*].*'</span> <span class="token operator">=</span> <span class="token number">3306</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_3-insert-update"><a href="#_3-insert-update" class="header-anchor">#</a> 3.insert,update</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>author<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_INSERT<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>author<span class="token punctuation">`</span></span> <span class="token punctuation">,</span><span class="token string">'$.name'</span> <span class="token punctuation">,</span><span class="token string">'heartape'</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>article_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">710848206937784320</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>JSON_OBJECT各种函数的不同:</p> <ul><li>JSON_INSERT 函数只有当属性不存在的时候,它才会将这个属性添加到对象中;</li> <li>JSON_REPLACE 函数只有在对象中找到该属性才会替换该属性;</li> <li>JSON_SET 函数,如果在对象中没有找到这个属性,就会添加这个属性到对象中,如果对象中有这个属性了,就会替换掉原来的属性.</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token string">'$'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> article_id <span class="token operator">=</span> <span class="token number">710848206937784320</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token string">'$[1]'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> article_id <span class="token operator">=</span> <span class="token number">710848206937784320</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article_test<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_REPLACE<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token string">'$[1]'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> article_id <span class="token operator">=</span> <span class="token number">710848206937784320</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>JSON_ARRAY各种函数的不同:</p> <ul><li>JSON_ARRAY_APPEND:在末尾添加。</li> <li>JSON_ARRAY_INSERT:在指定位置添加，当前位置以及后面的元素后移。</li> <li>JSON_REPLACE:在指定位置更新。</li></ul> <h3 id="_4-delete"><a href="#_4-delete" class="header-anchor">#</a> 4.delete</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>author<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_REMOVE<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>author<span class="token punctuation">`</span></span> <span class="token punctuation">,</span><span class="token string">'$.name'</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> article_id <span class="token operator">=</span> <span class="token number">710848206937784320</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token identifier"><span class="token punctuation">`</span>article<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> JSON_REMOVE<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>label_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token string">'$[1]'</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> article_id <span class="token operator">=</span> <span class="token number">710848206937784320</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_4-常用函数"><a href="#_4-常用函数" class="header-anchor">#</a> 4.常用函数</h2> <h3 id="_1-数学函数"><a href="#_1-数学函数" class="header-anchor">#</a> 1.数学函数</h3> <table><thead><tr><th>函数</th> <th>作用</th> <th>说明</th></tr></thead> <tbody><tr><td>ABS(X)</td> <td>求绝对值</td> <td>ABS(-3.14)=3.14</td></tr> <tr><td>SQR(X)</td> <td>求算数平方根</td> <td>SQRT(9)=3</td></tr> <tr><td>MOD(N,M)</td> <td>求余数</td> <td>MOD(9,5)=4</td></tr> <tr><td>CEIL(X)</td> <td>即向上取整</td> <td>CEIL(6.2)=7</td></tr> <tr><td>FLOOR(X)</td> <td>向下取整，返回值转化为一个BIGINT</td> <td>FLOOR(3.6)=3</td></tr> <tr><td>RAND()</td> <td>生成一个0~1之间的随机数</td> <td>RAND()=0.4684512908276648</td></tr> <tr><td>RAND(X)</td> <td>X一样的话结果就一样</td> <td>RAND(1)=0.40540353712197724</td></tr> <tr><td>ROUND(X)</td> <td>四舍五入</td> <td>ROUND(3.556)=3.5</td></tr> <tr><td>ROUND(X,D)</td> <td>四舍五入，保留D位小数</td> <td>ROUND(3.556,2)=3.56</td></tr> <tr><td>SIGN(X)</td> <td>返回参数的符号</td> <td>SIGN(0)=0;SIGN(3)=1;SIGN(-3)=-1</td></tr> <tr><td>POW(X,Y)</td> <td>X的Y次方</td> <td>POW(2,3)=8</td></tr> <tr><td>POWER(X,Y)</td> <td>X的Y次方</td> <td>POWER(2,3)=8</td></tr></tbody></table> <h3 id="_2-字符串函数"><a href="#_2-字符串函数" class="header-anchor">#</a> 2.字符串函数</h3> <table><thead><tr><th>函数</th> <th>作用</th> <th>说明</th></tr></thead> <tbody><tr><td>LENGTH(str)</td> <td>字符串字节数</td> <td></td></tr> <tr><td>CONCAT(str1,str2,…)</td> <td>合并字符串</td> <td></td></tr> <tr><td>INSERT(str,start,length,newStr)</td> <td>将str中指定start位置开始length长度的内容替换为newStr</td> <td>INSERT('123456',2,4,'000')='10006'</td></tr> <tr><td>LOWER(str)</td> <td>将字符串中的字母转换为小写</td> <td></td></tr> <tr><td>UPPER(str)</td> <td>将字符串中的字母转换为大写</td> <td></td></tr> <tr><td>LEFT(str,len)</td> <td>从左侧字截取字符串，返回字符串左边的len个字符</td> <td>LEFT(‘123456’,2)=‘12’</td></tr> <tr><td>RIGHT(str,len)</td> <td>从右侧字截取字符串，返回字符串右边的len个字符</td> <td>RIGHT(‘123456’,2)=‘56’</td></tr> <tr><td>TRIM(str)</td> <td>删除字符串左右两侧的空格</td> <td></td></tr> <tr><td>REPLACE(str,s1,s2)</td> <td>字符串替换，s2替换s1</td> <td></td></tr> <tr><td>SUBSTRING(str,start,length)</td> <td>截取字符串</td> <td></td></tr> <tr><td>REVERSE(str)</td> <td>字符串反转(逆序)</td> <td>REVERSE(‘123456789’)：‘987654321’</td></tr></tbody></table> <h3 id="_3-日期和时间函数"><a href="#_3-日期和时间函数" class="header-anchor">#</a> 3.日期和时间函数</h3> <table><thead><tr><th>函数</th> <th>作用</th> <th>说明</th></tr></thead> <tbody><tr><td>CURDATE() 和 CURRENT_DATE</td> <td>当前系统的日期</td> <td></td></tr> <tr><td>CURTIME() 和 CURRENT_TIME</td> <td>当前系统的时间</td> <td></td></tr> <tr><td>NOW() 和 SYSDATE()</td> <td>当前系统的日期和时间</td> <td></td></tr> <tr><td>UNIX_TIMESTAMP()</td> <td>UNIX时间戳函数</td> <td></td></tr> <tr><td>FROM_UNIXTIME(X)</td> <td>将UNIX时间戳转换为时间格式，与UNIX_TIMESTAMP()互为反函数</td> <td></td></tr> <tr><td>MONTH(date)</td> <td>日期中的月份</td> <td></td></tr> <tr><td>MONTHNAME(date)</td> <td>日期中的月份英文名称</td> <td></td></tr> <tr><td>DAYNAME(date)</td> <td>曰期对应的星期几的英文名称</td> <td></td></tr> <tr><td>DAYOFWEEK(date)</td> <td>日期对应的一周的索引位置值</td> <td>WEEKDAY('2022-03-16') = 4</td></tr> <tr><td>WEEKDAY(date)</td> <td>日期在一周内的对应的工作日索引</td> <td>WEEKDAY('2022-03-16') = 2</td></tr> <tr><td>WEEK(date)</td> <td>日期是一年中的第几周</td> <td></td></tr> <tr><td>DAYOFYEAR(date)</td> <td>曰期是一年中的第几天</td> <td></td></tr> <tr><td>DAYOFMONTH(date)</td> <td>日期是一个月中是第几天</td> <td></td></tr> <tr><td>YEAR(date)</td> <td>年份</td> <td></td></tr> <tr><td>TIME_TO_SEC(time)</td> <td>将时间参数转换为秒数</td> <td></td></tr> <tr><td>SEC_TO_TIME(seconds)</td> <td>将秒数转换为时间，与TIME_TO_SEC互为反函数</td> <td></td></tr> <tr><td>DATE_ADD(date, INTERVAL)</td> <td>向日期添加指定的时间间隔</td> <td>DATE_ADD('2022-03-16',INTERVAL 1 day) = 2022-03-17</td></tr> <tr><td>ADDDATE(date, INTERVAL)</td> <td>向日期添加指定的时间间隔</td> <td>ADDDATE('2022-03-16',1) = 2022-03-17</td></tr> <tr><td>DATE_SUB(date, INTERVAL)</td> <td>向日期减去指定的时间间隔</td> <td>DATE_SUB('2022-03-16',INTERVAL 1 day) = 2022-03-15</td></tr> <tr><td>SUBDATE(date, INTERVAL)</td> <td>向日期减去指定的时间间隔</td> <td>SUBDATE('2022-03-16',1) = 2022-03-15</td></tr> <tr><td>ADDTIME(time,INTERVAL)</td> <td>时间加法运算</td> <td></td></tr> <tr><td>SUBTIME(time,INTERVAL)</td> <td>时间减法运算</td> <td></td></tr> <tr><td>DATEDIFF(date1,date2)</td> <td>两个日期之间间隔</td> <td></td></tr> <tr><td>DATE_FORMAT(date,format)</td> <td>格式化指定的日期</td> <td></td></tr></tbody></table> <h3 id="_4-流程控制函数"><a href="#_4-流程控制函数" class="header-anchor">#</a> 4.流程控制函数</h3> <table><thead><tr><th>函数</th> <th>作用</th> <th>说明</th></tr></thead> <tbody><tr><td>IF(expr,v1,v2)</td> <td>expr为真是返回v1，否则返回v2。</td> <td></td></tr> <tr><td>IFNULL(v1,v2)</td> <td>如果v1不为NULL，则返回v1,否则返回v2。</td> <td></td></tr> <tr><td>CASE</td> <td>搜索语句</td> <td>sum(case when role = 'admin' then 1 else 0 end)</td></tr></tbody></table></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2023/4/18 11:56:58</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:2;" data-v-248d85d6></canvas></div><!----><div class="RibbonAnimation"></div><div id="goTop" class="hide-cat" data-v-bf92849a></div><div></div><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;left:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:1;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.9604687e.js" defer></script><script src="/assets/js/3.67b42e06.js" defer></script><script src="/assets/js/1.ba3d0679.js" defer></script><script src="/assets/js/67.869a3181.js" defer></script>
  </body>
</html>
